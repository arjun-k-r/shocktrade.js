<div ng-hide="contest._id" class="spectator_message" style="display: block; width: 100%">
	<div ng-include src="'/assets/views/play/no_contest_selected_dash.htm'"></div>
</div>
<div ng-if="contest._id" style="background-color: #ffffff; width: 100%; height: 550px">
	<div style="display:block; border: 1px solid #dddddd; border-radius: 4px 4px 4px 4px; margin-top: 5px">
		<table style="width: 100%; margin-bottom: 5px">
			<tr style="background-color: #dddddd">
				<th class="det"><span style="padding-left: 8px">Created By</span></th> 
				<th class="det">Date Created</th> 
				<th class="det">Initial Funds</th> 
				<th class="det">Status</th> 
				<th class="det">Starts</th> 
				<th class="det">Ends</th> 
			</tr>
			<tr>
				<td class="det">
					<span style="padding-left: 8px">
						<a href="" ng-click="loadGamerCard(contest.creator)">{{ contest.creator }}</a>
					</span>
				</td>
				<td class="det">{{ contest.creationTime.$date | date:'MMM dd hh:mma' }}</td>
				<td class="det">${{ contest.startingBalance | number }}</td>		
				<td class="det"><span ng-class="contestStatusClass(contest)">{{ contest.status }}</span></td>
				<td class="det">{{ contest.startTime.$date | date:'MM/dd/yy' }}</td>
				<td class="det">{{ contest.expirationTime.$date | date:'MM/dd/yy' }}</td>
			</tr>		
		</table>
	
		<div ng-show="contest.status == 'ACTIVE'" style="display: block; width: 100%; padding: 2px 2px 2px 2px">
			<!-- 'Join' option -->
			<div style="display: inline; float: left">
				<button ng-show="authenticated && contest.playerCount < contest.maxParticipants && !containsPlayer(contest, MySession.userProfile.name)" class="joinButton">Join Game</button>
			</div>
			
			<!-- 'Quit' or 'Delete' option -->
			<div style="display: inline; float: right">
				<button ng-show="contest.creator == MySession.userProfile.name" class="quitButton" ng-click="deleteGame()">Delete Game</button>
				<button ng-show="contest.creator != MySession.userProfile.name && joinedPariticpant(contest, MySession.userProfile.name)" class="quitButton" ng-click="quitGame()">Quit Game</button>
			</div>
			<br style="clear: both">
		</div>
	</div>
	
	<div style="display: block; width: 100%; margin-top: 5px" ng-repeat="p in contest.rankings">
		<div ng-class="p.name ? 'rank_cell_player' : 'rank_cell_spectator'" ng-class-odd="'rank_cell_even'" ng-class-even="'rank_cell_odd'">
			<div style="display: inline; float: left">
				<avatar id="{{ p.facebookID }}" style="margin: 3px; width: 45px; height: 45px" />
			</div>
			<div style="display: inline">
				<div style="display: block">
					<span ng-class="'rank_' + p.rank">{{ p.rank }} <span class="null">&#8212;</span>  
						<a ng-show="p.name" style="color: #0000ff" href="" ng-click="showGamerCard(p.name)">{{ p.name }}</a>
						<span ng-hide="p.name" style="color: #00a044">
							Open/Available 
							<button class="invite" ng-show="containsPlayer(contest, MySession.userProfile.name)" 
									ng-click="invitePlayer()"
									style="float: right; margin-right: 20px">Invite</button>
							<button ng-hide="containsPlayer(contest, MySession.userProfile.name)" 
									style="float: right; margin-right: 20px">Join</button>
						</span>
					</span>
					<div style="display: inline; float: right; margin-right: 10px">
						<img ng-if="contest.status == 'CLOSED' && p.rank == '1st'" src="/assets/images/contests/gold.png">
						<img ng-if="contest.status == 'CLOSED' && p.rank == '2nd'" src="/assets/images/contests/silver.png">
						<img ng-if="contest.status == 'CLOSED' && p.rank == '3rd'" src="/assets/images/contests/bronze.png">
					</div>
				</div>
				<div style="display: block">
					<span class="rank_label">Net Worth:</span> 
					<span class="positive">${{ p.totalEquity | number:2 }}</span>
					<span ng-class="p.gainLoss >= 0 ? 'positive' : 'negative'">
					<changearrow ng-hide="(p.gainLoss || 0) == 0" value="{{ p.gainLoss }}" />
					<span ng-if="(p.gainLoss || 0) == 0" class="null">&#8212;</span>
					<span ng-if="p.gainLoss > 0">+</span>{{ p.gainLoss | number:2 }}%
					</span>
				</div>	
				<div style="display: block">
					<span class="rank_label">Score:</span> 
					<span style="color: #0080ff">{{ p.score | number }} pts</span>
					<span style="float: right; padding-right: 10px" ng-if="p.gainLoss >= 25">
						<img ng-repeat="n in starRating(p.gainLoss)" src="/assets/images/status/star.png">
					</span>
				</div>
			</div>	
		</div>
	</div>
	<br style="clear: both">
</div>

<script type="text/ng-template" id="invite_player.htm">
	<div class="modal-header">
   		<h3>Send Game Invite(s)</h3>
    </div>
    <div class="modal-body">
		<div class="gameline">
			{{ getInvitedCount() }} Friend(s) Selected
		</div>
		<div style="display: inline; float: left; width: 60%">
			<div class="friendsContainer">
				<table style="width: 100%">
					<tr ng-repeat="friend in MySession.fbFriends">
						<td>
							<input type="checkbox" ng-model="invites[$index]">
							<avatar id="{{ friend.id }}" style="width: 16px; height: 16px" />
							{{ friend.name }}
						</td>
					</tr>
				</table>
			</div>
		</div>
		<div style="display: inline; float: right; width: 40%">
			<textarea style="width: 200px; height: 200px">Come play with us!</textarea>
		</div>
		<br style="clear: both">
    </div>
	<div class="modal-footer">
    	<button class="btn btn-primary" ng-click="ok()">Send</button>
        <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
    </div>
</script>
